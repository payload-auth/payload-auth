---
title: Collection Overrides
description: Customizing auto-generated collections
---

import { Callout } from 'fumadocs-ui/components/callout';

# Collection Overrides

Modify the collections generated by payload-auth without breaking functionality.

## Basic Override Pattern

```ts
betterAuthPlugin({
  users: {
    collectionOverrides: ({ collection }) => {
      return {
        ...collection,
        // Your modifications
      }
    },
  },
})
```

## Adding Fields

```ts
betterAuthPlugin({
  users: {
    collectionOverrides: ({ collection }) => ({
      ...collection,
      fields: [
        ...collection.fields,
        {
          name: 'bio',
          type: 'textarea',
        },
        {
          name: 'dateOfBirth',
          type: 'date',
        },
        {
          name: 'preferences',
          type: 'group',
          fields: [
            { name: 'theme', type: 'select', options: ['light', 'dark'] },
            { name: 'newsletter', type: 'checkbox' },
          ],
        },
      ],
    }),
  },
})
```

## Modifying Existing Fields

```ts
betterAuthPlugin({
  users: {
    collectionOverrides: ({ collection }) => ({
      ...collection,
      fields: collection.fields.map(field => {
        // Make name required
        if (field.name === 'name') {
          return { ...field, required: true }
        }
        // Add validation to email
        if (field.name === 'email') {
          return {
            ...field,
            validate: (value) => {
              if (!value?.endsWith('@company.com')) {
                return 'Must use company email'
              }
              return true
            },
          }
        }
        return field
      }),
    }),
  },
})
```

## Adding Hooks

```ts
betterAuthPlugin({
  users: {
    collectionOverrides: ({ collection }) => ({
      ...collection,
      hooks: {
        ...collection.hooks,
        afterChange: [
          ...(collection.hooks?.afterChange ?? []),
          async ({ doc, operation }) => {
            if (operation === 'create') {
              // Send welcome email
              await sendWelcomeEmail(doc.email)
            }
            return doc
          },
        ],
      },
    }),
  },
})
```

## Adding Endpoints

```ts
betterAuthPlugin({
  users: {
    collectionOverrides: ({ collection }) => ({
      ...collection,
      endpoints: [
        ...(collection.endpoints ?? []),
        {
          path: '/me/preferences',
          method: 'patch',
          handler: async (req) => {
            const body = await req.json()
            // Update user preferences
            return Response.json({ success: true })
          },
        },
      ],
    }),
  },
})
```

## Modifying Access

```ts
betterAuthPlugin({
  sessions: {
    collectionOverrides: ({ collection }) => ({
      ...collection,
      access: {
        ...collection.access,
        read: ({ req }) => {
          // Only allow users to read their own sessions
          if (!req.user) return false
          return {
            user: { equals: req.user.id },
          }
        },
      },
    }),
  },
})
```

## Plugin Collection Overrides

Override collections from Better Auth plugins:

```ts
betterAuthPlugin({
  pluginCollectionOverrides: {
    organizations: ({ collection }) => ({
      ...collection,
      fields: [
        ...collection.fields,
        {
          name: 'website',
          type: 'text',
        },
        {
          name: 'industry',
          type: 'select',
          options: ['tech', 'finance', 'healthcare'],
        },
      ],
    }),
    passkeys: ({ collection }) => ({
      ...collection,
      admin: {
        ...collection.admin,
        hidden: true, // Hide passkeys from admin
      },
    }),
  },
})
```

## Controlling JWT/Cookie Content

Use `saveToJWT` to control what's included in session cookies:

```ts
betterAuthPlugin({
  users: {
    collectionOverrides: ({ collection }) => ({
      ...collection,
      fields: collection.fields.map(field => {
        // Exclude sensitive data from cookie cache
        if (field.name === 'privateNotes') {
          return { ...field, saveToJWT: false }
        }
        return field
      }),
    }),
  },
})
```

<Callout type="warn" title="Important">
Don't remove fields that payload-auth depends on. The plugin validates that all required fields exist.
</Callout>

## Required Fields

Required fields vary by collection:

| Collection | Required Fields |
|------------|-----------------|
| users | `email`, `emailVerified`, `role` |
| sessions | `token`, `user`, `expiresAt` |
| accounts | `accountId`, `providerId`, `user` |
| verifications | `identifier`, `value`, `expiresAt` |
