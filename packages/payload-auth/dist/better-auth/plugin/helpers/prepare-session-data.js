import { getFieldsToSign } from "payload";
export async function prepareUser({ user, userCollection }) {
    const newUser = getFieldsToSign({
        collectionConfig: userCollection,
        email: user.email,
        user: {
            ...user,
            collection: userCollection.slug
        }
    });
    return newUser;
}
export async function prepareSession({ session, sessionCollection }) {
    const filteredSession = getFieldsToSign({
        collectionConfig: sessionCollection,
        email: '',
        user: {
            ...session,
            collection: sessionCollection.slug
        }
    });
    delete filteredSession.email;
    delete filteredSession.collection;
    Object.assign(filteredSession, {
        userId: session.userId
    });
    return filteredSession;
}
/**
 * Prepares session data for cookie cache by filtering user and session objects
 * based on the payload configuration's 'saveToJwt' property
 */ export async function prepareSessionData({ sessionData, usersCollection, sessionsCollection }) {
    if (!sessionData || !sessionData.user) return null;
    const newUser = await prepareUser({
        user: sessionData.user,
        userCollection: usersCollection
    });
    const newSession = await prepareSession({
        session: sessionData.session,
        sessionCollection: sessionsCollection
    });
    const newSessionData = {
        session: newSession,
        user: newUser
    };
    return newSessionData;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9iZXR0ZXItYXV0aC9wbHVnaW4vaGVscGVycy9wcmVwYXJlLXNlc3Npb24tZGF0YS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFNlc3Npb24sIFVzZXIgfSBmcm9tICdiZXR0ZXItYXV0aCdcbmltcG9ydCB0eXBlIHsgQ29sbGVjdGlvbkNvbmZpZyB9IGZyb20gJ3BheWxvYWQnXG5pbXBvcnQgeyBnZXRGaWVsZHNUb1NpZ24gfSBmcm9tICdwYXlsb2FkJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJlcGFyZVVzZXIoeyB1c2VyLCB1c2VyQ29sbGVjdGlvbiB9OiB7IHVzZXI6IFVzZXIgJiBSZWNvcmQ8c3RyaW5nLCBhbnk+OyB1c2VyQ29sbGVjdGlvbjogQ29sbGVjdGlvbkNvbmZpZyB9KSB7XG4gIGNvbnN0IG5ld1VzZXIgPSBnZXRGaWVsZHNUb1NpZ24oe1xuICAgIGNvbGxlY3Rpb25Db25maWc6IHVzZXJDb2xsZWN0aW9uLFxuICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgIHVzZXI6IHtcbiAgICAgIC4uLnVzZXIsXG4gICAgICBjb2xsZWN0aW9uOiB1c2VyQ29sbGVjdGlvbi5zbHVnXG4gICAgfVxuICB9KVxuXG4gIHJldHVybiBuZXdVc2VyIGFzIFVzZXIgJiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcmVwYXJlU2Vzc2lvbih7XG4gIHNlc3Npb24sXG4gIHNlc3Npb25Db2xsZWN0aW9uXG59OiB7XG4gIHNlc3Npb246IFNlc3Npb24gJiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4gIHNlc3Npb25Db2xsZWN0aW9uOiBDb2xsZWN0aW9uQ29uZmlnXG59KSB7XG4gIGNvbnN0IGZpbHRlcmVkU2Vzc2lvbiA9IGdldEZpZWxkc1RvU2lnbih7XG4gICAgY29sbGVjdGlvbkNvbmZpZzogc2Vzc2lvbkNvbGxlY3Rpb24sXG4gICAgZW1haWw6ICcnLFxuICAgIHVzZXI6IHtcbiAgICAgIC4uLnNlc3Npb24sXG4gICAgICBjb2xsZWN0aW9uOiBzZXNzaW9uQ29sbGVjdGlvbi5zbHVnXG4gICAgfVxuICB9KVxuXG4gIGRlbGV0ZSBmaWx0ZXJlZFNlc3Npb24uZW1haWxcbiAgZGVsZXRlIGZpbHRlcmVkU2Vzc2lvbi5jb2xsZWN0aW9uXG4gIE9iamVjdC5hc3NpZ24oZmlsdGVyZWRTZXNzaW9uLCB7XG4gICAgdXNlcklkOiBzZXNzaW9uLnVzZXJJZFxuICB9KVxuXG4gIHJldHVybiBmaWx0ZXJlZFNlc3Npb24gYXMgU2Vzc2lvbiAmIFJlY29yZDxzdHJpbmcsIGFueT5cbn1cblxuLyoqXG4gKiBQcmVwYXJlcyBzZXNzaW9uIGRhdGEgZm9yIGNvb2tpZSBjYWNoZSBieSBmaWx0ZXJpbmcgdXNlciBhbmQgc2Vzc2lvbiBvYmplY3RzXG4gKiBiYXNlZCBvbiB0aGUgcGF5bG9hZCBjb25maWd1cmF0aW9uJ3MgJ3NhdmVUb0p3dCcgcHJvcGVydHlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByZXBhcmVTZXNzaW9uRGF0YSh7XG4gIHNlc3Npb25EYXRhLFxuICB1c2Vyc0NvbGxlY3Rpb24sXG4gIHNlc3Npb25zQ29sbGVjdGlvblxufToge1xuICBzZXNzaW9uRGF0YToge1xuICAgIHNlc3Npb246IFNlc3Npb24gJiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4gICAgdXNlcjogVXNlciAmIFJlY29yZDxzdHJpbmcsIGFueT5cbiAgfVxuICB1c2Vyc0NvbGxlY3Rpb246IENvbGxlY3Rpb25Db25maWdcbiAgc2Vzc2lvbnNDb2xsZWN0aW9uOiBDb2xsZWN0aW9uQ29uZmlnXG59KSB7XG4gIGlmICghc2Vzc2lvbkRhdGEgfHwgIXNlc3Npb25EYXRhLnVzZXIpIHJldHVybiBudWxsXG5cbiAgY29uc3QgbmV3VXNlciA9IGF3YWl0IHByZXBhcmVVc2VyKHsgdXNlcjogc2Vzc2lvbkRhdGEudXNlciwgdXNlckNvbGxlY3Rpb246IHVzZXJzQ29sbGVjdGlvbiB9KVxuICBjb25zdCBuZXdTZXNzaW9uID0gYXdhaXQgcHJlcGFyZVNlc3Npb24oeyBzZXNzaW9uOiBzZXNzaW9uRGF0YS5zZXNzaW9uLCBzZXNzaW9uQ29sbGVjdGlvbjogc2Vzc2lvbnNDb2xsZWN0aW9uIH0pXG5cbiAgY29uc3QgbmV3U2Vzc2lvbkRhdGEgPSB7XG4gICAgc2Vzc2lvbjogbmV3U2Vzc2lvbixcbiAgICB1c2VyOiBuZXdVc2VyXG4gIH1cblxuICByZXR1cm4gbmV3U2Vzc2lvbkRhdGFcbn1cbiJdLCJuYW1lcyI6WyJnZXRGaWVsZHNUb1NpZ24iLCJwcmVwYXJlVXNlciIsInVzZXIiLCJ1c2VyQ29sbGVjdGlvbiIsIm5ld1VzZXIiLCJjb2xsZWN0aW9uQ29uZmlnIiwiZW1haWwiLCJjb2xsZWN0aW9uIiwic2x1ZyIsInByZXBhcmVTZXNzaW9uIiwic2Vzc2lvbiIsInNlc3Npb25Db2xsZWN0aW9uIiwiZmlsdGVyZWRTZXNzaW9uIiwiT2JqZWN0IiwiYXNzaWduIiwidXNlcklkIiwicHJlcGFyZVNlc3Npb25EYXRhIiwic2Vzc2lvbkRhdGEiLCJ1c2Vyc0NvbGxlY3Rpb24iLCJzZXNzaW9uc0NvbGxlY3Rpb24iLCJuZXdTZXNzaW9uIiwibmV3U2Vzc2lvbkRhdGEiXSwibWFwcGluZ3MiOiJBQUVBLFNBQVNBLGVBQWUsUUFBUSxVQUFTO0FBRXpDLE9BQU8sZUFBZUMsWUFBWSxFQUFFQyxJQUFJLEVBQUVDLGNBQWMsRUFBMEU7SUFDaEksTUFBTUMsVUFBVUosZ0JBQWdCO1FBQzlCSyxrQkFBa0JGO1FBQ2xCRyxPQUFPSixLQUFLSSxLQUFLO1FBQ2pCSixNQUFNO1lBQ0osR0FBR0EsSUFBSTtZQUNQSyxZQUFZSixlQUFlSyxJQUFJO1FBQ2pDO0lBQ0Y7SUFFQSxPQUFPSjtBQUNUO0FBRUEsT0FBTyxlQUFlSyxlQUFlLEVBQ25DQyxPQUFPLEVBQ1BDLGlCQUFpQixFQUlsQjtJQUNDLE1BQU1DLGtCQUFrQlosZ0JBQWdCO1FBQ3RDSyxrQkFBa0JNO1FBQ2xCTCxPQUFPO1FBQ1BKLE1BQU07WUFDSixHQUFHUSxPQUFPO1lBQ1ZILFlBQVlJLGtCQUFrQkgsSUFBSTtRQUNwQztJQUNGO0lBRUEsT0FBT0ksZ0JBQWdCTixLQUFLO0lBQzVCLE9BQU9NLGdCQUFnQkwsVUFBVTtJQUNqQ00sT0FBT0MsTUFBTSxDQUFDRixpQkFBaUI7UUFDN0JHLFFBQVFMLFFBQVFLLE1BQU07SUFDeEI7SUFFQSxPQUFPSDtBQUNUO0FBRUE7OztDQUdDLEdBQ0QsT0FBTyxlQUFlSSxtQkFBbUIsRUFDdkNDLFdBQVcsRUFDWEMsZUFBZSxFQUNmQyxrQkFBa0IsRUFRbkI7SUFDQyxJQUFJLENBQUNGLGVBQWUsQ0FBQ0EsWUFBWWYsSUFBSSxFQUFFLE9BQU87SUFFOUMsTUFBTUUsVUFBVSxNQUFNSCxZQUFZO1FBQUVDLE1BQU1lLFlBQVlmLElBQUk7UUFBRUMsZ0JBQWdCZTtJQUFnQjtJQUM1RixNQUFNRSxhQUFhLE1BQU1YLGVBQWU7UUFBRUMsU0FBU08sWUFBWVAsT0FBTztRQUFFQyxtQkFBbUJRO0lBQW1CO0lBRTlHLE1BQU1FLGlCQUFpQjtRQUNyQlgsU0FBU1U7UUFDVGxCLE1BQU1FO0lBQ1I7SUFFQSxPQUFPaUI7QUFDVCJ9